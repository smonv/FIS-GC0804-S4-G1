<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core">

    <ui:composition template="/templates/admin/layout.xhtml">
        <f:metadata>
            <f:viewParam name="pid" value="#{adminEditImageProduct.pid}" />
            <f:viewAction action="#{adminEditImageProduct.init()}" />
        </f:metadata>
        <ui:define name="title">Product Images</ui:define>
        <ui:define name="content">
            <div class="container-fluid">
                <div class="row">
                    <h:messages style="list-style: none; padding: 0px; color: red"/>
                    <p>Preview</p>
                    <img id="uploadPreview" style="width: 555px; height: auto; max-height: 336px;border: solid 1px #cccccc; margin-bottom: 15px" />
                    <br/>
                    <h:form enctype="multipart/form-data">
                        <h:inputFile value="#{adminEditImageProduct.upload_img}" id="uploadImage" class="form-control"  onchange="PreviewImage();" style="width: 555px; background: #ebebeb; border: none">
                            <f:validator validatorId="imageValidator" />
                        </h:inputFile>
                        <br/>
                        <h:commandButton value="Upload"  action="#{adminEditImageProduct.upload()}" class="btn btn-primary"/>
                        &nbsp;
                        <h:link value="Back" outcome="/admin/product/view.xhtml">
                            <f:param name="pid" value="#{adminEditImageProduct.pid}" />
                        </h:link>
                    </h:form>
                    
                    <div class="col-lg-6 col-md-6">

                        <h:messages style="list-style: none; padding: 0px; color: red"/>

                        <h:form enctype="multipart/form-data">
                            <h:inputFile value="#{adminEditImageProduct.upload_img}" id="uploadImage" class="form-control"  onchange="PreviewImage();">
                                <f:validator validatorId="imageValidator" />
                            </h:inputFile>
                            <br/>
                            <h:commandButton value="Upload"  action="#{adminEditImageProduct.upload()}" class="btn btn-primary"/>
                            &nbsp;
                            <h:link value="Back" outcome="/admin/product/view.xhtml">
                                <f:param name="pid" value="#{adminEditImageProduct.pid}" />
                            </h:link>
                        </h:form>
                    </div>
                    <div class="col-lg-6 col-md-6">
                        <img id="uploadPreview" style="height: auto; max-height: 300px;border: solid 2px #cccccc; margin-bottom: 15px" />
                    </div>

                </div>
                <div class="row" style="border: solid 1px #ebebeb; padding: 10px 0 10px 0; margin-top: 20px">
                    <p style="margin-top: 0px; width: 100%; height: 25px; border-bottom:solid 1px #ebebeb; padding-left: 10px">
                        Images 
                    </p>
                    <ui:repeat value="#{adminEditImageProduct.product.productImagesList}" var="pi"
                               rendered="#{adminEditImageProduct.product.productImagesList.size() gt 0}">                               
                        <div class="col-md-2
                             #{adminEditImageProduct.product.productImagesList.indexOf(pi) != 0 ? null:'active'}" style="padding:1px; min-height: 170px">
                            <h:graphicImage 
                                value="/image/#{pi.imgId.imgPath}" 
                                styleClass="img-responsive" style="width: 100%; height: 100%; position: absolute"/>

                            <h:form>
                                <h:commandButton value="Remove" action="#{adminEditImageProduct.upload()}" class="btn btn-primary remove-btn-box"/>
                            </h:form>
                        </div>
                    </ui:repeat>

                </div>
            </div>                
            <script type="text/javascript">
                function PreviewImage() {
                    var oFReader = new FileReader();
                    oFReader.readAsDataURL(document.getElementById("j_idt80:uploadImage").files[0]);

                    oFReader.onload = function (oFREvent) {
                        document.getElementById("uploadPreview").src = oFREvent.target.result;
                    };
                }
            </script>
            <style>
                .col-md-2:hover{
                   
                }
                .remove-btn-box{
                    bottom: 0px;
                    width: 100%;
                    height: 30px;
                    background: black;
                    opacity: 0.7;
                    position: absolute;
                    padding: 0px;
                    margin: 0px;
                    left: 0;
                    display: none;
                    border-radius: 0px;
                }
                .col-md-2:hover > form> .remove-btn-box{
                    display: block;
                }
            </style>
        </ui:define>
    </ui:composition>
</html>

